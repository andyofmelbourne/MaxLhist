\documentclass[11pt]{article}
\usepackage{amsmath}
%Gummi|065|=)
\title{\textbf{Finding adu distributions or finding photons}}
\author{Andrew Morgan}
\date{}
\usepackage{graphicx}
\begin{document}

\maketitle

\section{Maximum Likelihood for a single random variable}
Thought experiment:

\begin{itemize}

  \item We have a single discrete random variable x with a probability distribution $f(x)$, where each value of $x$ is independent from the last. 
  \item $x$ is measured $N$ times. In the interval from $0$ to $I-1$.
  \item This is repeated $M$ times. Yielding the set of values $x^m_n$.

\end{itemize}

\textbf{Question}: Can we determine $f(x)$ from the set of $x^m_n$ values?

The probability that a single value $x^m_n$ is equal to $x$, given a distribution $f(x)$, is given by:
\begin{align}
   Pr(x^m_n = x; f) = f(x)
\end{align}

After $N$ trials the probablity of measuring the value $x$ $h^m_x$ times is:
\begin{align}
   Pr(h^m_x = k; f) = \frac{N!}{k!(N-k)!} f(x)^k \times (1-f(x))^{1-k}
\end{align}

After $N$ trials the probablity of measuring the set of values $x^m_n$ $h^m_x$ times is:
\begin{align}
   Pr(x^m_n; f) = \frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!} \prod_{x=0}^{I-1} f(x)^{h^m_{x}}
\end{align}


After $M$ sets of $N$ trials the probability of measuring the set of values $x^m_n$ $h^m_x$ times is:
\begin{align}
   Pr(x^m_n; f) = \prod_{m=0}^{M-1}\frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!} \prod_{x=0}^{I-1} f(x)^{h^m_{x}}
\end{align}
In principle we should not care about the ordering of $x$ samples between pixels (values of $m$). However when the number of samples for each pixel is large this should not effect the analysis too much. 

The log likelihood is then:
\begin{align}
   \varepsilon(f) &= -\ln(Pr(x^m_n; f)) = -\ln\left(\prod_{m=0}^{M-1}\frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!} \prod_{x=0}^{I-1} f(x)^{h^m_{x}}\right) \\
   &= -\sum_{m=0}^{M-1}\ln\left(\frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!} \prod_{x=0}^{I-1} f(x)^{h^m_{x}}\right) \\
   &= -\sum_{m=0}^{M-1}\left[\ln\left(\frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!}\right) +\ln\left(\prod_{x=0}^{I-1} f(x)^{h^m_{x}}\right) \right]\\
   &= -\sum_{m=0}^{M-1}\left[\ln\left(\frac{N!}{h^m_0! h^m_1! \cdots h^m_{I-1}!}\right) +\sum_{x=0}^{I-1} h^m_x \ln\left(f(x)\right) \right]\\
\end{align}



\end{document}